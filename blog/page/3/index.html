
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Ruby Studio Blog</title>
  <meta name="author" content="Svilen Vassilev">

  
  <meta name="description" content="If you happen to use non-ASCII characters in a ruby file within your rails app, say a controller,
library, database seeds, etc, you might have the &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.rubystudio.net/blog/page/3/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Ruby Studio Blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-1746369-13']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Ruby Studio Blog</a></h1>
  
    <h2>Agile web development and IT solutions</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.rubystudio.net" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">All posts</a></li>
  <li><a href="/blog/categories/ruby-studio/">News</a></li>
  <li><a href="/blog/categories/tips/">Tips</a></li>
  <li><a href="/blog/categories/discoveries/">Discoveries</a></li>
  <li><a href="/blog/categories/quotes/">Quotes</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="http://rubystudio.net">Rubystudio.net</a></li>
</ul>


</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/09/15/dealing-with-the-invalid-multibyte-char-error/">Dealing With the “invalid Multibyte Char” Error</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-09-15T18:51:00+03:00" pubdate data-updated="true">Sep 15<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>If you happen to use non-ASCII characters in a ruby file within your rails app, say a controller,
library, database seeds, etc, you might have the invalid multibyte char (US-ASCII) error thrown
at you by ruby 1.9.x. This is something you’re bound to experience if you’re developing an app
that is localized in a language that utilizes non-ASCII characters and you’re not using the i18n
libraries of rails to define your strings. The solution is very easy and feels almost magical:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># encoding: utf-8</span></code></pre></td></tr></table></div></figure>


<p>Put this line of code on top of all scripts that raise the error. Unfortunately there seems to be
no way to deal with it on application level with a single entry. It&#8217;s Ruby legacy, but perhaps it
should be considered as a Rails default for future versions.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/09/13/piwik-the-in-house-web-analytics-solution/">Piwik - the In-house Web Analytics Solution</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-09-13T18:57:00+03:00" pubdate data-updated="true">Sep 13<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img class="right" src="http://i.imgur.com/WJ3WNb.png?1"></p>

<p>All piblic websites need a way to track their visitors and while Google Analytics remains
the de-facto standart for web analytics, in certain cases customers prefer alternatives.
There might be several reasons to opt for an alternative, to name but a few:</p>

<ul>
<li>the customer might not trust Google or generally any external service with their web data</li>
<li>the customer might want features that are missing from Google analytcis, such as real-time analytics</li>
<li>the customer might want a more sophisticated API without quota limits to pull their data</li>
</ul>


<p>Granted we still use and recommend Google analytics as the primary solution here at Ruby Studio,
we looked for possible alternatives in an effort to accomodate these user cases.</p>

<p>For live tracking the popular choice is <a href="http://www.woopra.com/">Woopra</a>, and we still use it on some of our
projects on customer request, however it has the downside of loading too much javascript too slowly and recent
tests we’ve made indicate that Woopra code takes about as much to load and process as all the rest
of our code and assets for a particular page put together. Some tweaks and hacks are possible for
performance improvement, but overall it remains too slow and hence not a primary choice for us.</p>

<p>Ideally we would have picked a Ruby based solution, so we considered <a href="http://www.railstat.com/">RailStat</a>,
but we decided it’s not yet mature enough for production, its feature set is still somewhat limited and
there seems to be no active development. We’ll be keeping an eye on it for the future.</p>

<p>So eventually our choice fell on <a href="http://piwik.org/">Piwik</a>. An open source project with rich feature set,
slick ajax-y interface, actively developed and maintained, with good market penetration (used on more than
150 000 sites). It also has a simplified, but fully working Live analytics module, allows extensive
customization and provides a rich API. Performance seems also quite good, the speed of getting and parsing
the tracking javascript seems on par with Google analytics, the impact on the webapp performance is minimal.</p>

<p>So we will be offering Piwik as an option for web analytics to our customers in 3 varieties:</p>

<ul>
<li>as part of our unified analytics service at <a href="http://analytics.rubystudio.net">analytics.rubystudio.net</a>.
This service will be used by multiple customers and web projects; user accounts for access and website
permissions will be set at per customer basis.</li>
<li>as a separate Piwik instance, hosted by us, but not shared with other customers or web sites,
and the customer will receive full administration rights for the instance.</li>
<li>as a customer-hosted solution. We can install and configure a Piwik instance for our customers
on their own servers or at their chosen hosting provider, and in this case the customer retains
all the privileges and responsibility of maintaining and hosting the software on their own</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/09/10/sitemaps-the-rails-3-dot-1-way/">Sitemaps: The Rails 3.1 Way</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-09-10T19:07:00+03:00" pubdate data-updated="true">Sep 10<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Having a sitemap for your website is a nice convention, it helps search engines find, index and build
an hierarchy of your pages and it also gives you some control of what content is parsed and how often.
At Ruby Studio we regard sitemaps as a mandatory aspect of development and SEO and always include them
in the apps we build, even if it’s a simple app with no much dynamic content, such as our
<a href="http://rubystudio.net/">current homepage</a>.</p>

<p>So what is our preferred method of incorporating sitemaps in rails applications? There is a really
easy way, by using a gem that is actively maintained and fully compatible with rails 3.1. As an extra
benefit, the gem is really well documented. It’s called <a href="http://rubygems.org/gems/sitemap_generator">sitemap_generator</a>.</p>

<p>Here’s how to get going with it in a few easy steps:</p>

<ul>
<li>Add <code>gem 'sitemap_generator'</code> to your Gemfile and run <code>bundle</code>. This will install the gem</li>
<li>Run <code>rake sitemap:install</code> to setup the gem. This will generate a <code>config/sitemap.rb</code> file which is your
sitemap configuration descriptor file. You can run this task on your development machine and there will be
no need to repeat the process for production.</li>
<li>Open your <code>sitemap.rb</code> file to define the pages you need included in your sitemap. Only the root home page
is included by default. In your <code>sitemap.rb</code> file you&#8217;ll find initially a block of code:</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">SitemapGenerator</span><span class="o">::</span><span class="no">Sitemap</span><span class="o">.</span><span class="n">default_host</span> <span class="o">=</span> <span class="s2">&quot;http://www.example.com&quot;</span>
</span><span class='line'><span class="no">SitemapGenerator</span><span class="o">::</span><span class="no">Sitemap</span><span class="o">.</span><span class="n">create</span> <span class="k">do</span>
</span><span class='line'><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="n">.</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Edit the file, inserting into the block the links to your pages or resources like this:</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">SitemapGenerator</span><span class="o">::</span><span class="no">Sitemap</span><span class="o">.</span><span class="n">default_host</span> <span class="o">=</span> <span class="s2">&quot;http://www.example.com&quot;</span>
</span><span class='line'><span class="no">SitemapGenerator</span><span class="o">::</span><span class="no">Sitemap</span><span class="o">.</span><span class="n">create</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">add</span> <span class="s1">&#39;/contact_us&#39;</span>
</span><span class='line'>  <span class="no">Content</span><span class="o">.</span><span class="n">find_each</span> <span class="k">do</span> <span class="o">|</span><span class="n">content</span><span class="o">|</span>
</span><span class='line'>    <span class="n">add</span> <span class="n">content_path</span><span class="p">(</span><span class="n">content</span><span class="p">),</span> <span class="ss">:lastmod</span> <span class="o">=&gt;</span> <span class="n">content</span><span class="o">.</span><span class="n">updated_at</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>As you can see from the example, static pages are added by a simple add declaration, and dynamic content can
be easily added by a nested block selector, polling your rails models and extracting blogs, articles or any
other dynamic assets you might have in your app. Neat and easy!</p>

<p>There are a number of supporter options you can add to your configuration to fine tune the crawling
frequency, priority, etc, such as:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">add</span> <span class="s1">&#39;/contact_us&#39;</span><span class="p">,</span> <span class="ss">:changefreq</span> <span class="o">=&gt;</span> <span class="s1">&#39;monthly&#39;</span>
</span><span class='line'><span class="n">add</span> <span class="s1">&#39;/about&#39;</span><span class="p">,</span> <span class="ss">:priority</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="o">.</span><span class="mi">75</span>
</span></code></pre></td></tr></table></div></figure>


<p>The full list is available in the <a href="http://rdoc.info/github/kjvarga/sitemap_generator/master/frames">gem documentation</a>.</p>

<ul>
<li>After writing the configuration, you’re ready to actually generate your sitemaps. Run <code>rake sitemap:refresh</code>.
This will create the sitemaps and put them in your public/ folder, appropriately compressing them with gzip
and naming them by default: <code>sitemap_index.xml.gz, sitemap1.xml.gz</code>, etc</li>
<li>Next you should add the path to your sitemap in your <code>robots.txt</code> file, so that the spiders can find it
automatically: <code>Sitemap: http://www.example.com/sitemap_index.xml.gz</code></li>
<li>Upon a sitemap generation, the script automatically notifies (pings) major search engines (Google, Yahoo,
Bing, Ask, SitemapWriter) that a new sitemap is available. In development you can disable the notification
by using instead <code>rake sitemap:refresh:no_ping</code></li>
<li>That’s all, you’re now ready to rumble with your new shiny sitemaps. In production you can add a crontab
entry (either manually, or using the <a href="http://rubygems.org/gems/whenever">whenever</a> gem) for the rake task
to automatically re-generate your sitemaps on, say, a daily basis. Here’s an example of raw crontab entry:</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>0 5 * * * /bin/bash -l -c <span class="s1">&#39;cd /path/to/webapp &amp;&amp; RAILS_ENV=production rake -s sitemap:refresh --silent&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Or an example whenever entry:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># config/schedule.rb</span>
</span><span class='line'><span class="n">every</span> <span class="mi">1</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="ss">:at</span> <span class="o">=&gt;</span> <span class="s1">&#39;5:00 am&#39;</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">rake</span> <span class="s2">&quot;-s sitemap:refresh&quot;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>The whole setup and deployment process takes some 15 minutes and is really flexible and configurable.
No more reasons to skip on this important part of search engine optimization and web development
best practices.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/09/09/development-focus-rubystudio-dot-net/">Development Focus: rubystudio.net</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-09-09T14:18:00+03:00" pubdate data-updated="true">Sep 9<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>We’ve launched the initial version of <a href="http://rubystudio.net/">our website</a> today. It has pretty basic functionality right now, and we regard it as merely the surface layer of a system that will eventually let us manage and administer our customers and their projects with ease and convenience. So much of what is planned is actually irrelevant to the general audience and will remain invisible in the public section of the site. Some important public sections though are still incomplete and we will focus on bringing them up in the following days. These are the portfolio and testimonials listings, the FAQ section and the IP.Trac pages which are perhaps the most important for us right now, since IP.Trac is currently our flagman product and it still lacks consistent documentation and user-friendly manual, even though it’s been used in production by ISPs for more than a year now, The fact of the matter is we needed web presence and we needed it quickly, to match the speed with which RubyStudio transitioned from a loosely linked group of individuals working occasionally together on random projects to a real company with its own face and branding.</p>

<p>Two things make us particularly happy about the current early version of the website. First is speed: it feels really fast; in a day or two we’ll have accumulated statistics for the average load times for our pages, but I expect them to be around half a second. Hats off to the asset pipeline and the rendering improvements in Rails 3.1! And second is the fact that it validates as HTML5 with no errors, which of course has to be expected, considering all the bragging about standards compliance we’ve put in our promo pages :)</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/2/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/07/01/sass-and-coffeescript-support-for-sublime-editor/">SASS and CoffeeScript support for Sublime Editor</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/06/27/blog-moved-to-octopress/">Blog moved to Octopress</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/06/26/new-version-of-our-website/">New version of our website</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/06/26/zsh-and-the-new-post-generator-in-octopress/">Zsh and the new_post generator in Octopress</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/06/26/cloning-remote-branches-with-git/">Cloning remote branches with Git</a>
      </li>
    
  </ul>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("rubystudionet", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/rubystudionet" class="twitter-follow-button" data-show-count="false">Follow @rubystudionet</a>
  
</section>



<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/117340949984241343695?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Ruby Studio -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'rubystudioblog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
